<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Digital MBS Member Card</title>

<link rel="manifest" href="manifest.json">

<script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.0/dist/JsBarcode.all.min.js"></script>
<script src="https://unpkg.com/html5-qrcode"></script>

<style>
:root { --primary:#0f172a; --accent:#3b82f6; }

body{
font-family:Inter,sans-serif;
background:#f1f5f9;
margin:0;
padding:20px;
display:flex;
flex-direction:column;
align-items:center;
padding-bottom:120px;
}

.setup-area{
background:white;
padding:30px;
border-radius:25px;
text-align:center;
width:100%;
max-width:350px;
box-shadow:0 10px 30px rgba(0,0,0,0.08);
}

input{
width:100%;
padding:15px;
border:2px solid #eee;
border-radius:12px;
font-size:1.1rem;
text-align:center;
margin-bottom:10px;
outline:none;
}

input:focus{border-color:var(--accent);}

.btn-main{
width:100%;
padding:15px;
border-radius:12px;
border:none;
background:var(--primary);
color:white;
font-weight:bold;
cursor:pointer;
margin-bottom:10px;
}

.btn-scan{background:#10b981;}

#reader{
width:100%;
border-radius:15px;
overflow:hidden;
display:none;
margin-bottom:15px;
}

#cardArea{
display:none;
width:100%;
max-width:380px;
flex-direction:column;
align-items:center;
animation:fadeIn .6s ease;
}

@keyframes fadeIn{
from{opacity:0;transform:translateY(10px);}
to{opacity:1;transform:translateY(0);}
}

.card-visual{
width:100%;
height:215px;
border-radius:22px;
background-size:cover;
background-position:center;
box-shadow:0 15px 35px rgba(0,0,0,0.2);
background-color:#334155;
}

.info-section{
background:white;
border-radius:20px;
padding:20px;
margin-top:-30px;
width:88%;
text-align:center;
box-shadow:0 10px 25px rgba(0,0,0,0.1);
z-index:5;
}

#memberIDOut{
font-size:1.4rem;
font-weight:800;
letter-spacing:2px;
color:var(--primary);
margin-bottom:10px;
}

.navbar{
position:fixed;
bottom:20px;
width:90%;
max-width:400px;
background:rgba(15,23,42,0.95);
backdrop-filter:blur(10px);
display:flex;
justify-content:space-around;
padding:15px;
border-radius:25px;
box-shadow:0 10px 30px rgba(0,0,0,0.3);
}

.nav-item{
color:white;
text-decoration:none;
text-align:center;
font-size:.75rem;
cursor:pointer;
}




.modal{
display:none;
position:fixed;
z-index:200;
left:0;
top:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.8);
}

.modal-content{
background:white;
margin:15% auto;
padding:25px;
width:85%;
max-width:400px;
border-radius:25px;
text-align:center;
position:relative;
}

.btn-delete{
margin-top:30px;
background:none;
border:1px solid #ccc;
color:#888;
padding:8px 15px;
border-radius:8px;
font-size:.7rem;
cursor:pointer;
}
</style>
</head>

<bod<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Digital MBS Member Card</title>

<link rel="manifest" href="manifest.json">

<script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.0/dist/JsBarcode.all.min.js"></script>
<script src="https://unpkg.com/html5-qrcode"></script>

<style>
:root{ --primary:#0f172a; --accent:#3b82f6; }

body{
font-family:Inter,sans-serif;
background:#f1f5f9;
margin:0;
padding:20px;
display:flex;
flex-direction:column;
align-items:center;
padding-bottom:120px;
}

.setup-area{
background:white;
padding:30px;
border-radius:25px;
text-align:center;
width:100%;
max-width:350px;
box-shadow:0 10px 30px rgba(0,0,0,0.08);
}

input{
width:100%;
padding:15px;
border:2px solid #eee;
border-radius:12px;
font-size:1.1rem;
text-align:center;
margin-bottom:10px;
outline:none;
}
input:focus{border-color:var(--accent);}

.btn-main{
width:100%;
padding:15px;
border-radius:12px;
border:none;
background:var(--primary);
color:white;
font-weight:bold;
cursor:pointer;
margin-bottom:10px;
}

.btn-scan{ background:#10b981; }

#reader{
width:100%;
border-radius:15px;
overflow:hidden;
display:none;
margin-bottom:15px;
}

#cardArea{
display:none;
width:100%;
max-width:380px;
flex-direction:column;
align-items:center;
animation:fadeIn .6s ease;
}

@keyframes fadeIn{
from{opacity:0;transform:translateY(10px);}
to{opacity:1;transform:translateY(0);}
}

.card-visual{
width:100%;
height:215px;
border-radius:22px;
background-size:cover;
background-position:center;
box-shadow:0 15px 35px rgba(0,0,0,0.2);
background-color:#334155;
}

.info-section{
background:white;
border-radius:20px;
padding:20px;
margin-top:-30px;
width:88%;
text-align:center;
box-shadow:0 10px 25px rgba(0,0,0,0.1);
z-index:5;
}

#memberIDOut{
font-size:1.4rem;
font-weight:800;
letter-spacing:2px;
color:var(--primary);
margin-bottom:10px;
}

.navbar{
position:fixed;
bottom:20px;
width:90%;
max-width:400px;
background:rgba(15,23,42,0.95);
backdrop-filter:blur(10px);
display:flex;
justify-content:space-around;
padding:15px;
border-radius:25px;
box-shadow:0 10px 30px rgba(0,0,0,0.3);
}

.nav-item{
color:white;
text-decoration:none;
text-align:center;
font-size:.75rem;
cursor:pointer;
}

.modal{
display:none;
position:fixed;
z-index:200;
left:0;
top:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.8);
}

.modal-content{
background:white;
margin:60px auto;
padding:25px;
width:85%;
max-width:400px;
border-radius:25px;
text-align:center;
position:relative;
max-height:80vh;
overflow:auto;
}

/* NEWS BUTTON */
.btn-link{
display:flex;
align-items:center;
justify-content:center;
gap:10px;
background:var(--accent);
color:white;
padding:12px;
margin:10px 0;
border-radius:14px;
text-decoration:none;
font-weight:bold;
font-size:0.9rem;
transition:.25s;
box-shadow:0 4px 10px rgba(0,0,0,0.08);
}

.btn-link:hover{
transform:translateY(-2px);
box-shadow:0 8px 18px rgba(0,0,0,0.15);
}

.btn-site{ background:#2563eb; }
.btn-shopee{ background:#ee4d2d; }
.btn-tiktok{ background:#000; }

.btn-delete{
margin-top:30px;
background:none;
border:1px solid #ccc;
color:#888;
padding:8px 15px;
border-radius:8px;
font-size:.7rem;
cursor:pointer;
}
</style>
</head>

<body>

<div id="setupArea" class="setup-area">
<h2>MBS DIGITAL</h2>
<p style="font-size:0.8rem;color:#666;margin-bottom:20px;">
Sila imbas barcode kad atau taip manual.
</p>

<div id="reader"></div>

<input type="text" id="memberInput" placeholder="Masukkan No. Ahli">

<button class="btn-main" onclick="activateCard()">SIMPAN KAD</button>
<button class="btn-main btn-scan" onclick="startScanner()">IMBAS BARCODE KAD</button>
</div>

<div id="cardArea">
<div id="visualBg" class="card-visual"></div>

<div class="info-section">
<div id="memberIDOut"></div>
<svg id="barcode"></svg>
<p style="font-size:.6rem;color:#999;margin-top:5px;">SILA IMBAS DI KAUNTER</p>
</div>

<button class="btn-delete" onclick="confirmDelete()">Hapus Kad dari Peranti</button>
</div>

<div class="navbar">
<div class="nav-item" onclick="location.reload()">
<div style="font-size:1.5rem">ü™™</div>KAD
</div>

<div class="nav-item" onclick="openNews()">
<div style="font-size:1.5rem">üî•</div>NEWS
</div>

<a href="https://wa.me/60175626166" class="nav-item">
<div style="font-size:1.5rem">üí¨</div>HELP
</a>
</div>

<div id="newsModal" class="modal">
<div class="modal-content">
<span style="position:absolute;right:20px;top:15px;cursor:pointer;"
onclick="closeNews()">‚úï</span>

<h3>Promosi Terkini!</h3>

<img src="https://via.placeholder.com/400x200?text=Poster+Promosi+MBS"
style="width:100%;border-radius:12px;">

<a href="https://sites.google.com/view/mbs-promo" target="_blank" class="btn-link btn-site">
üåê Google Sites Katalog
</a>

<a href="https://shopee.com.my/" target="_blank" class="btn-link btn-shopee">
üß° Shopee MBS
</a>

<a href="https://tiktok.com/" target="_blank" class="btn-link btn-tiktok">
üñ§ TikTok MBS
</a>

<button onclick="closeNews()">Tutup</button>
</div>
</div>

<script>
const STORAGE_KEY="mbs_digital_id";
let html5QrCode=null;
let scanned=false;

window.onload=function(){
const savedID=localStorage.getItem(STORAGE_KEY);
if(savedID) renderCard(savedID);
};

function activateCard(){
let id=document.getElementById("memberInput").value.trim().toUpperCase();

if(!/^[A-Z0-9-]+$/.test(id)){
alert("Format ID tidak sah");
return;
}

localStorage.setItem(STORAGE_KEY,id);
renderCard(id);
}

function renderCard(id){
document.getElementById("setupArea").style.display="none";
document.getElementById("cardArea").style.display="flex";
document.getElementById("memberIDOut").innerText=id;

const visual=document.getElementById("visualBg");

if(id.startsWith("3")){
visual.style.backgroundImage="url('png1.png')";
visual.style.backgroundColor="#1e3a8a";
}else if(id.startsWith("9")){
visual.style.backgroundImage="url('png2.png')";
visual.style.backgroundColor="#991b1b";
}else{
visual.style.backgroundColor="#334155";
}

JsBarcode("#barcode",id,{
format:"CODE128",
width:2.5,
height:60,
displayValue:false
});
}

function startScanner(){

if(location.protocol!=="https:" && location.hostname!=="localhost"){
alert("Scanner perlu HTTPS");
return;
}

document.getElementById("reader").style.display="block";

if(!html5QrCode){
html5QrCode=new Html5Qrcode("reader");
}

scanned=false;

const config={fps:10,qrbox:{width:250,height:150}};

html5QrCode.start({facingMode:"environment"},config,
(decodedText)=>{

if(scanned) return;
scanned=true;

document.getElementById("memberInput").value=decodedText;

html5QrCode.stop().then(()=>{
html5QrCode.clear();
document.getElementById("reader").style.display="none";
activateCard();
});

}).catch(err=>{
console.error(err);
});
}

function confirmDelete(){
const jawapan=prompt("Taip DELETE untuk sahkan pemadaman:");
if(jawapan==="DELETE"){
localStorage.removeItem(STORAGE_KEY);
location.reload();
}
}

function openNews(){
document.getElementById("newsModal").style.display="block";
}

function closeNews(){
document.getElementById("newsModal").style.display="none";
}
</script>

</body>
</html>
